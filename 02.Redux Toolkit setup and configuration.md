# Redux Toolkit Setup and Configuration

## Overview

Redux Toolkit is the official, opinionated, batteries-included toolset for efficient Redux development. This guide covers installing Redux Toolkit, configuring your store, and setting up your application to use Redux.

---

## 1. Prerequisites

Before starting, ensure you have:

- A React application (created with Vite, Create React App, or similar)
- Node.js and npm installed
- Basic understanding of Redux concepts (see 01.Prerequisite Knowledge.md)

---

## 2. Installation

### Install Redux Toolkit and React-Redux

```bash
npm install @reduxjs/toolkit react-redux
```

### What Gets Installed

- **@reduxjs/toolkit**: Core Redux Toolkit library
- **react-redux**: React bindings for Redux (connects React components to Redux store)

### Verify Installation

Check your `package.json`:

```json
{
	"dependencies": {
		"@reduxjs/toolkit": "^1.9.x",
		"react-redux": "^8.1.x",
		"react": "^18.x"
	}
}
```

---

## 3. Creating Your First Redux Store

### Basic Store Setup

Create a new file: `src/store/store.js`

```javascript
import { configureStore } from "@reduxjs/toolkit";

const store = configureStore({
	reducer: {},
});

export default store;
```

### What `configureStore` Does

- Creates a Redux store with good defaults
- Automatically includes Redux middleware (redux-thunk for async operations)
- Enables Redux DevTools extension
- Handles reducer composition

---

## 4. Setting Up the Provider

### Wrap Your App with Redux Provider

In `src/main.jsx`:

```javascript
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App.jsx";
import store from "./store/store.js";
import { Provider } from "react-redux";
import "./index.css";

ReactDOM.createRoot(document.getElementById("root")).render(
	<React.StrictMode>
		<Provider store={store}>
			<App />
		</Provider>
	</React.StrictMode>,
);
```

### Why Provider?

The `Provider` component makes the Redux store available to all React components in the application.

---

## 5. Creating Slices (Reducers)

### What is a Slice?

A slice is a collection of reducer logic and actions for a single feature. Redux Toolkit's `createSlice` simplifies reducer and action creation.

### Example: Counter Slice

Create `src/store/slices/counterSlice.js`:

```javascript
import { createSlice } from "@reduxjs/toolkit";

const counterSlice = createSlice({
	name: "counter",
	initialState: {
		value: 0,
	},
	reducers: {
		increment: (state) => {
			state.value += 1;
		},
		decrement: (state) => {
			state.value -= 1;
		},
		incrementByAmount: (state, action) => {
			state.value += action.payload;
		},
	},
});

export const { increment, decrement, incrementByAmount } = counterSlice.actions;
export default counterSlice.reducer;
```

### Key Features of `createSlice`

- Automatically generates action creators
- Allows "mutating" state directly (Immer handles immutability)
- Combines reducer and actions in one place
- Reduces boilerplate significantly

---

## 6. Registering Slices with Store

### Update `src/store/store.js`

```javascript
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./slices/counterSlice";

const store = configureStore({
	reducer: {
		counter: counterReducer,
	},
});

export default store;
```

### Store Structure

```javascript
{
	counter: {
		value: 0;
	}
}
```

---

## 7. Using Redux in React Components

### Basic Usage with Hooks

Create `src/components/Counter.jsx`:

```javascript
import { useSelector, useDispatch } from "react-redux";
import {
	increment,
	decrement,
	incrementByAmount,
} from "../store/slices/counterSlice";

function Counter() {
	const count = useSelector((state) => state.counter.value);
	const dispatch = useDispatch();

	return (
		<div>
			<h1>Counter: {count}</h1>
			<button onClick={() => dispatch(increment())}>Increment</button>
			<button onClick={() => dispatch(decrement())}>Decrement</button>
			<button onClick={() => dispatch(incrementByAmount(5))}>
				Increment by 5
			</button>
		</div>
	);
}

export default Counter;
```

### Understanding the Hooks

- **`useSelector`**: Extracts data from Redux store (like subscribe)
- **`useDispatch`**: Provides dispatch function to send actions

---

## 8. Complete Project Structure

```
src/
├── components/
│   ├── Counter.jsx
│   └── Display.jsx
├── store/
│   ├── store.js
│   └── slices/
│       ├── counterSlice.js
│       └── userSlice.js
├── App.jsx
├── main.jsx
└── index.css
```

---

## 9. Multiple Slices Example

### Create User Slice: `src/store/slices/userSlice.js`

```javascript
import { createSlice } from "@reduxjs/toolkit";

const userSlice = createSlice({
	name: "user",
	initialState: {
		name: "",
		email: "",
		isLoggedIn: false,
	},
	reducers: {
		setUser: (state, action) => {
			state.name = action.payload.name;
			state.email = action.payload.email;
			state.isLoggedIn = true;
		},
		logout: (state) => {
			state.name = "";
			state.email = "";
			state.isLoggedIn = false;
		},
	},
});

export const { setUser, logout } = userSlice.actions;
export default userSlice.reducer;
```

### Update Store

```javascript
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./slices/counterSlice";
import userReducer from "./slices/userSlice";

const store = configureStore({
	reducer: {
		counter: counterReducer,
		user: userReducer,
	},
});

export default store;
```

### Store Structure with Multiple Slices

```javascript
{
  counter: {
    value: 0
  },
  user: {
    name: '',
    email: '',
    isLoggedIn: false
  }
}
```

---

## 10. Redux DevTools Integration

### Automatic Setup

Redux DevTools are automatically enabled by `configureStore()`.

### Install Browser Extension

1. Install Redux DevTools for [Chrome](https://chrome.google.com/webstore) or [Firefox](https://addons.mozilla.org/firefox/)
2. Restart your browser
3. Open DevTools (F12) and look for "Redux" tab

### What You Can Do

- View all dispatched actions
- Inspect state changes
- Time-travel debugging (replay actions)
- Dispatch actions manually
- Export/import action logs

---

## 11. Middleware Configuration

### Default Middleware Included

`configureStore` includes by default:

- **redux-thunk**: For async operations (async actions)
- **SerializabilityCheckMiddleware**: Warns about non-serializable state
- **ImmutabilityCheckMiddleware**: Warns about state mutations

### Custom Middleware Example

```javascript
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./slices/counterSlice";

const logger = (store) => (next) => (action) => {
	console.log("dispatching", action);
	let result = next(action);
	console.log("next state", store.getState());
	return result;
};

const store = configureStore({
	reducer: {
		counter: counterReducer,
	},
	middleware: (getDefaultMiddleware) => getDefaultMiddleware().concat(logger),
});

export default store;
```

---

## 12. Environment-Specific Configuration

### Development vs Production

```javascript
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./slices/counterSlice";

const store = configureStore({
	reducer: {
		counter: counterReducer,
	},
	devTools: process.env.NODE_ENV !== "production",
});

export default store;
```

---

## 13. Selectors for State Access

### Creating Selector Files

Create `src/store/selectors.js`:

```javascript
export const selectCounterValue = (state) => state.counter.value;
export const selectUserName = (state) => state.user.name;
export const selectIsLoggedIn = (state) => state.user.isLoggedIn;
```

### Using Selectors

```javascript
import { useSelector } from "react-redux";
import { selectCounterValue } from "../store/selectors";

function Counter() {
	const count = useSelector(selectCounterValue);
	// ...
}
```

### Benefits of Selectors

- Centralized state access logic
- Easier refactoring
- Reusability across components
- Better performance (memoization)

---

## 14. Common Configuration Options

### `configureStore` Parameters

```javascript
configureStore({
	reducer, // Root reducer or object of slices
	middleware, // Custom middleware configuration
	devTools, // Enable/disable Redux DevTools
	preloadedState, // Initial state
	enhancers, // Store enhancers
	serializedActionSanitizer, // Customize action serialization warning
	serializedStateSanitizer, // Customize state serialization warning
});
```

### Example with Options

```javascript
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./slices/counterSlice";

const preloadedState = {
	counter: {
		value: 5,
	},
};

const store = configureStore({
	reducer: {
		counter: counterReducer,
	},
	preloadedState,
	devTools: {
		trace: true,
		traceLimit: 25,
	},
});

export default store;
```

---

## 15. Setup Checklist

- [ ] Redux Toolkit and React-Redux installed
- [ ] Store created with `configureStore`
- [ ] Provider wraps entire application
- [ ] At least one slice created with `createSlice`
- [ ] Slice reducer registered in store
- [ ] Redux DevTools extension installed
- [ ] Components using `useSelector` and `useDispatch`
- [ ] Test store configuration works

---

## 16. Complete Working Example

### File: `src/store/store.js`

```javascript
import { configureStore } from "@reduxjs/toolkit";
import counterReducer from "./slices/counterSlice";

const store = configureStore({
	reducer: {
		counter: counterReducer,
	},
});

export default store;
```

### File: `src/store/slices/counterSlice.js`

```javascript
import { createSlice } from "@reduxjs/toolkit";

const counterSlice = createSlice({
	name: "counter",
	initialState: {
		value: 0,
	},
	reducers: {
		increment: (state) => {
			state.value += 1;
		},
		decrement: (state) => {
			state.value -= 1;
		},
	},
});

export const { increment, decrement } = counterSlice.actions;
export default counterSlice.reducer;
```

### File: `src/main.jsx`

```javascript
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App.jsx";
import store from "./store/store.js";
import { Provider } from "react-redux";
import "./index.css";

ReactDOM.createRoot(document.getElementById("root")).render(
	<React.StrictMode>
		<Provider store={store}>
			<App />
		</Provider>
	</React.StrictMode>,
);
```

### File: `src/App.jsx`

```javascript
import { useSelector, useDispatch } from "react-redux";
import { increment, decrement } from "./store/slices/counterSlice";

function App() {
	const count = useSelector((state) => state.counter.value);
	const dispatch = useDispatch();

	return (
		<div>
			<h1>Counter App</h1>
			<p>Current Count: {count}</p>
			<button onClick={() => dispatch(increment())}>Increment</button>
			<button onClick={() => dispatch(decrement())}>Decrement</button>
		</div>
	);
}

export default App;
```

---

## 17. Troubleshooting Common Issues

### Issue: "Cannot read property 'value' of undefined"

**Cause**: Store not properly wrapped with Provider or reducer not registered

**Solution**:

1. Check Provider wraps root component
2. Verify reducer is registered in configureStore

### Issue: Redux DevTools not showing

**Cause**: Extension not installed or devTools disabled

**Solution**:

1. Install Redux DevTools extension
2. Check `devTools` option is not set to false
3. Clear browser cache

### Issue: "You may not update the state during render"

**Cause**: Dispatching action during render

**Solution**: Use effects for side effects

```javascript
import { useEffect } from "react";

useEffect(() => {
	dispatch(someAction());
}, [dispatch]);
```

---

## Next Steps

Now that Redux Toolkit is set up:

1. Learn about async operations with `createAsyncThunk`
2. Explore advanced slicing patterns
3. Implement selectors and reselect
4. Handle error states in reducers
5. Optimize performance with memoization

---

## Resources

- [Redux Toolkit Documentation](https://redux-toolkit.js.org/)
- [React-Redux Hooks API](https://react-redux.js.org/api/hooks)
- [Redux DevTools Documentation](https://github.com/reduxjs/redux-devtools)
- [Immer Documentation](https://immerjs.github.io/immer/)
